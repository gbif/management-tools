<div class="card-area">
  <md-card>
    <md-nav-bar
      md-no-ink-bar="disableInkBar"
      md-selected-nav-item="$ctrl.currentNavItem"
      nav-bar-aria-label="navigation links">
      <md-nav-item md-nav-href="#" name="tool">
        Crawling Monitor
      </md-nav-item>
      <md-nav-item md-nav-href="#" name="about">
        About
      </md-nav-item>
    </md-nav-bar>

    <div ng-show="$ctrl.currentNavItem == 'tool'">
      <div layout="row" layout-xs="column" layout-padding ng-if="!$ctrl.rowCollection">
        <md-input-container class="md-block" flex="auto">
          <label>Search table</label>
          <input ng-model="$ctrl.state.query">
        </md-input-container>
        <md-input-container flex="initial">
          <md-checkbox ng-model="$ctrl.isLive" ng-change="$ctrl.changeLive($ctrl.isLive)" aria-label="Live view">
            Live view
          </md-checkbox>
        </md-input-container>
        <!--<md-input-container flex="initial" style="width:200px">-->
          <!--<label>How many entries to show</label>-->
          <!--<md-select ng-model="$ctrl.state.pageSize">-->
            <!--<md-option ng-repeat="pageSize in $ctrl.pageSizes" ng-value="pageSize.nr">-->
              <!--{{pageSize.name}}-->
            <!--</md-option>-->
          <!--</md-select>-->
        <!--</md-input-container>-->
      </div>

      <md-content class="md-padding white">
        <div class="table-container">
          <table class="gb-table-linked table-striped">
            <thead>
            <!--<tr>-->
              <!--<th ng-repeat="col in $ctrl.tableColumns" class="tableHeader-rotated">-->
                <!--<div>{{col.full}}</div>-->
              <!--</th>-->
              <!--<th></th>-->
            <!--</tr>-->
            <tr>
              <th ng-repeat="col in $ctrl.tableColumns" title="{{col.full}}" class="whiteSpace-nowrap">
                <a class="btnLink" href=""
                   ng-click="$ctrl.state.sortType = col.field; $ctrl.state.sortReverse = !$ctrl.state.sortReverse">
                  <md-tooltip md-direction="top">{{col.full}}</md-tooltip>
                  <span class="inline-block">
                      {{ col.abbr }}
                      <span ng-show="$ctrl.state.sortType == col.field && !$ctrl.state.sortReverse"
                            class="sortOrder">&#x25B2;</span>
                      <span ng-show="$ctrl.state.sortType == col.field && $ctrl.state.sortReverse"
                            class="sortOrder">&#x25BC;</span>
                  </span>
                </a>
              </th>
              <th></th>
            </tr>
            </thead>
            <tbody>
            <!-- add md-whiteframe-4dp class to row on hover ? -->
            <tr ng-repeat-start="row in $ctrl.crawls | filter:$ctrl.state.query | orderBy:$ctrl.state.sortType:$ctrl.state.sortReverse | limitTo:$ctrl.state.pageSize">
              <td ng-repeat="col in $ctrl.tableColumns">
                <span ng-if="col.field == '_url'">{{row[col.field] | simplifyHttpUrls}}</span>
                <span ng-if="col.field != '_url'" class="text-{{row._status[col.field]}}">
                  {{row[col.field] | localNumber}}
                  <md-tooltip md-direction="top">{{col.full}}</md-tooltip>
                </span>
              </td>
              <!--<td>{{row.startedCrawling | amDateFormat:'YYYY-MM-DD HH:mm'}}</td>-->
              <!--<td>{{row.finishedCrawling | amDateFormat:'YYYY-MM-DD HH:mm'}}</td>-->
              <!--<td>{{$ctrl.getDuration(row) | amDurationFormat : 'hours'}}</td>-->
              <!--<td ng-show="$ctrl.showAll">{{ row.finishReason }}</td>-->
              <!--<td class="text-right" ng-show="$ctrl.showAll">-->
                <!--<span ng-if="row.fragmentsReceived - row.rawOccurrencesPersistedNew -row.rawOccurrencesPersistedUpdated - row.rawOccurrencesPersistedUnchanged - row.rawOccurrencesPersistedError == 0">{{row.fragmentsReceived | localNumber}}</span>-->
                <!--<span class="badge-red"-->
                      <!--ng-if="row.fragmentsReceived - row.rawOccurrencesPersistedNew -row.rawOccurrencesPersistedUpdated - row.rawOccurrencesPersistedUnchanged - row.rawOccurrencesPersistedError != 0">-->
                                        <!--{{row.fragmentsReceived | localNumber}}-->
                                        <!--<md-tooltip md-direction="top">Received fragments expected to equal New + Updated + Unchanged + Errors</md-tooltip>-->
                                    <!--</span>-->
              <!--</td>-->
              <!--<td class="text-right">{{row.rawOccurrencesPersistedNew | localNumber}}</td>-->
              <!--<td class="text-right">{{row.rawOccurrencesPersistedUpdated | localNumber}}</td>-->
              <!--<td class="text-right">{{row.rawOccurrencesPersistedUnchanged | localNumber}}</td>-->
              <!--<td class="text-right" ng-show="$ctrl.showAll">-->
                <!--<span ng-class="{'badge-red': row.rawOccurrencesPersistedError > 0}">{{row.rawOccurrencesPersistedError | localNumber}}</span>-->
              <!--</td>-->
              <!--<td class="text-right">-->
                                <!--<span ng-click="$ctrl.expandedRowMap[$index] = !$ctrl.expandedRowMap[$index]" class="btnLink">-->
                                    <!--<i class="material-icons">more_vert</i>-->
                                <!--</span>-->
              <!--</td>-->
            <!--</tr>-->
            <tr ng-repeat-end ng-if="$ctrl.expandedRowMap[$index] && ($ctrl.showAll || row.finishReason === 'NORMAL')">
              <td colspan="9">
                <code>
                  <pre>{{row | json : spacing}}
                  </pre>
                </code>
              </td>
            </tr>
            </tbody>
          </table>
        </div>

        <div class="emptyInfo" ng-if="$ctrl.crawls.length === 0">
          <h3>No crawls is running currently</h3>
        </div>

      </md-content>
    </div>

    <div ng-show="$ctrl.currentNavItem == 'about'">
      <md-content class="md-padding white">
        <div ng-bind-html="$ctrl.aboutContent"></div>
      </md-content>
    </div>

  </md-card>

</div>
